ggplot(data=speech.list,aes(x=year,y=people))+
geom_point()+
geom_smooth(method="lm",se=F)
#people
for (i in 1:nrow(speech.list))
{
speech.list$people[i]=length(gregexpr("people",speech.list$fulltext[i])[[1]])/sppech.list$Words[i]
}
#people
for (i in 1:nrow(speech.list))
{
speech.list$people[i]=length(gregexpr("people",speech.list$fulltext[i])[[1]])/speech.list$Words[i]
}
ggplot(data=speech.list,aes(x=year,y=people))+
geom_point()+
geom_smooth(method="lm",se=F)
#people
for (i in 1:nrow(speech.list))
{
speech.list$people[i]=length(gregexpr("govern",speech.list$fulltext[i])[[1]])/speech.list$Words[i]
}
ggplot(data=speech.list,aes(x=year,y=people))+
geom_point()+
geom_smooth(method="lm",se=F)
#people
for (i in 1:nrow(speech.list))
{
speech.list$people[i]=length(gregexpr("govern",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=people))+
geom_point()+
geom_smooth(method="lm",se=F)
#people
for (i in 1:nrow(speech.list))
{
speech.list$people[i]=length(gregexpr("govern",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=people))+
geom_point()+
geom_smooth(se=F)
#people
for (i in 1:nrow(speech.list))
{
speech.list$people[i]=length(gregexpr("people",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=people))+
geom_point()+
geom_smooth(se=F)
#people
for (i in 1:nrow(speech.list))
{
speech.list$people[i]=length(gregexpr("people",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=people))+
geom_point()+
geom_smooth(method="lm",se=F)
#govern
for (i in 1:nrow(speech.list))
{
speech.list$people[i]=length(gregexpr("govern",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=people))+
geom_point(color="red")+
geom_smooth(method="lm",se=F)
#people
for (i in 1:nrow(speech.list))
{
speech.list$people[i]=length(gregexpr("people",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=people))+
geom_point(color="red"))+
#people
for (i in 1:nrow(speech.list))
{
speech.list$people[i]=length(gregexpr("people",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=people))+
geom_point(color="red")+
geom_smooth(method="lm",se=F)
#govern
for (i in 1:nrow(speech.list))
{
speech.list$people[i]=length(gregexpr("govern",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=people))+
geom_point(color="red")+
geom_smooth(method="lm",se=F)
#people
for (i in 1:nrow(speech.list))
{
speech.list$people[i]=length(gregexpr("people",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=people))+
geom_point(color="red")+
geom_smooth(method="lm",se=F)
#govern
for (i in 1:nrow(speech.list))
{
speech.list$govern[i]=length(gregexpr("govern",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=govern))+
geom_point(color="red")+
geom_smooth(method="lm",se=F)
#people
for (i in 1:nrow(speech.list))
{
speech.list$people[i]=length(gregexpr("people",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=people))+
geom_point(color="yellow")+
geom_smooth(method="lm",se=F)
#govern
for (i in 1:nrow(speech.list))
{
speech.list$govern[i]=length(gregexpr("govern",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=govern))+
geom_point(color="red")+
geom_smooth(method="lm",se=F)
#people
for (i in 1:nrow(speech.list))
{
speech.list$people[i]=length(gregexpr("people",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=people))+
geom_point(color="purple")+
geom_smooth(method="lm",se=F)
#govern
for (i in 1:nrow(speech.list))
{
speech.list$govern[i]=length(gregexpr("govern",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=govern))+
geom_point(color="red")+
geom_smooth(method="lm",se=F)
#people
for (i in 1:nrow(speech.list))
{
speech.list$people[i]=length(gregexpr("people",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=people))+
geom_point(color="purple")+
geom_smooth(method="lm",se=F)
#govern
for (i in 1:nrow(speech.list))
{
speech.list$govern[i]=length(gregexpr("govern",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=govern))+
geom_bar(color="red")+
geom_smooth(method="lm",se=F)
#people
for (i in 1:nrow(speech.list))
{
speech.list$people[i]=length(gregexpr("people",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=people))+
geom_point(color="purple")+
geom_smooth(method="lm",se=F)
#govern
for (i in 1:nrow(speech.list))
{
speech.list$govern[i]=length(gregexpr("govern",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=govern,color="red"))+
geom_bar()+
geom_smooth(method="lm",se=F)
#people
for (i in 1:nrow(speech.list))
{
speech.list$people[i]=length(gregexpr("people",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=people))+
geom_point(color="purple")+
geom_smooth(method="lm",se=F)
#govern
for (i in 1:nrow(speech.list))
{
speech.list$govern[i]=length(gregexpr("govern",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=govern,color="red"))+
geom_bar(stat="identity")+
geom_smooth(method="lm",se=F)
#people
for (i in 1:nrow(speech.list))
{
speech.list$people[i]=length(gregexpr("people",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=people))+
geom_point(color="purple")+
geom_smooth(method="lm",se=F)
#govern
for (i in 1:nrow(speech.list))
{
speech.list$govern[i]=length(gregexpr("govern",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=govern))+
geom_bar(stat="identity")+
geom_smooth(method="lm",se=F,color="red")
#people
for (i in 1:nrow(speech.list))
{
speech.list$people[i]=length(gregexpr("people",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=people))+
geom_point(color="purple")+
geom_smooth(method="lm",se=F)
#govern
for (i in 1:nrow(speech.list))
{
speech.list$govern[i]=length(gregexpr("govern",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=govern))+
geom_line()+
geom_smooth(method="lm",se=F,color="red")
#people
for (i in 1:nrow(speech.list))
{
speech.list$people[i]=length(gregexpr("people",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=people))+
geom_point(color="purple")+
geom_smooth(method="lm",se=F)
#govern
for (i in 1:nrow(speech.list))
{
speech.list$govern[i]=length(gregexpr("govern",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=govern))+
geom_line(cex=.5)+
geom_smooth(method="lm",se=F,color="red")
#people
for (i in 1:nrow(speech.list))
{
speech.list$people[i]=length(gregexpr("people",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=people))+
geom_line()+
geom_smooth(method="lm",se=F)
#govern
for (i in 1:nrow(speech.list))
{
speech.list$govern[i]=length(gregexpr("govern",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=govern))+
geom_line()+
geom_smooth(method="lm",se=F,color="red")
#people
for (i in 1:nrow(speech.list))
{
speech.list$people[i]=length(gregexpr("people",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=people))+
geom_point(color="purple")+
geom_smooth(method="lm",se=F)
#govern
for (i in 1:nrow(speech.list))
{
speech.list$govern[i]=length(gregexpr("govern",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=govern))+
geom_point(color="red")+
geom_smooth(method="lm",se=F)
#people
for (i in 1:nrow(speech.list))
{
speech.list$people[i]=length(gregexpr("people",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=people))+
geom_point(color="purple")+
geom_smooth(method="lm",se=F)
#govern
for (i in 1:nrow(speech.list))
{
speech.list$govern[i]=length(gregexpr("govern",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=govern))+
geom_point(color="pink")+
geom_smooth(method="lm",se=F)
#people
for (i in 1:nrow(speech.list))
{
speech.list$people[i]=length(gregexpr("people",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=people))+
geom_point(color="purple")+
geom_smooth(method="lm",se=F)
#govern
for (i in 1:nrow(speech.list))
{
speech.list$govern[i]=length(gregexpr("govern",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=govern))+
geom_point(color="orange")+
geom_smooth(method="lm",se=F)
#people
for (i in 1:nrow(speech.list))
{
speech.list$people[i]=length(gregexpr("people",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=people))+
geom_point(color="purple")+
geom_smooth(method="lm",se=F)
#govern
for (i in 1:nrow(speech.list))
{
speech.list$govern[i]=length(gregexpr("govern",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=govern))+
geom_point(color="orange")+
geom_smooth(method="lm",se=F,color="red")
for (i in 1:nrow(speech.list))
{
speech.list$people[i]=length(gregexpr("great",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=people))+
geom_point(color="purple")+
geom_smooth(method="lm",se=F)
for (i in 1:nrow(speech.list))
{
speech.list$people[i]=length(gregexpr("great",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=people))+
geom_bar()+
for (i in 1:nrow(speech.list))
{
speech.list$people[i]=length(gregexpr("great",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=people))+
geom_bar()
for (i in 1:nrow(speech.list))
{
speech.list$people[i]=length(gregexpr("great",speech.list$fulltext[i])[[1]])/speech.list$Words[i]*100
}
ggplot(data=speech.list,aes(x=year,y=people))+
geom_bar(stat="identity")
for (i in 1:nrow(speech.list))
{
speech.list$people[i]=length(gregexpr("great",speech.list$fulltext[i])[[1]])
}
ggplot(data=speech.list,aes(x=year,y=people))+
geom_bar(stat="identity")
for (i in 1:nrow(speech.list))
{
speech.list$people[i]=length(gregexpr("great",speech.list$fulltext[i])[[1]])
}
ggplot(data=speech.list,aes(x=year,y=people,color="red"))+
geom_bar(stat="identity")
which.max()
for (i in 1:nrow(speech.list))
{
speech.list$great[i]=length(gregexpr("great",speech.list$fulltext[i])[[1]])
}
ggplot(data=speech.list,aes(x=year,y=great))+
geom_bar(stat="identity")
which.max(speech.list$great)
for (i in 1:nrow(speech.list))
{
speech.list$great[i]=length(gregexpr("great",speech.list$fulltext[i])[[1]])
}
ggplot(data=speech.list,aes(x=year,y=great))+
geom_bar(stat="identity")
speech.list[which.max(speech.list$great),1:8]
for (i in 1:nrow(speech.list))
{
speech.list$great[i]=length(gregexpr("great",speech.list$fulltext[i])[[1]])/speech.list$Words[i]
}
ggplot(data=speech.list,aes(x=year,y=great))+
geom_bar(stat="identity")
speech.list[which.max(speech.list$great),1:8]
folder.path="../data/InauguralSpeeches/"
fulltext<-Corpus(DirSource(folder.path))
fulltext<-tm_map(fulltext, stripWhitespace)
fulltext<-tm_map(fulltext, content_transformer(tolower))
fulltext<-tm_map(fulltext, removeWords, stopwords("english"))
fulltext<-tm_map(fulltext, removeWords, character(0))
fulltext<-tm_map(fulltext, removePunctuation)
fulltext<-tm_map(fulltext, stemDocument)
text<-tm_map(fulltext, stripWhitespace)
fulltext<-tm_map(fulltext, removePunctuation)
fulltext<-tm_map(fulltext, removeNumbers)
fulltext<-tm_map(fulltext, PlainTextDocument)
tdm <- TermDocumentMatrix(fulltext)
tdms <- removeSparseTerms(tdm, 0.1)
freq <- sort(colSums(as.matrix(tdm)), decreasing=TRUE)
wf <- data.frame(word=names(freq), freq=freq)
ggplot(subset(wf, freq>200), aes(word, freq))+
geom_bar(stat="identity")+
theme(axis.text.x=element_text(angle=45, hjust=1))
packages.used=c("rvest", "tibble", "qdap",
"sentimentr", "gplots", "dplyr",
"tm", "syuzhet", "factoextra",
"beeswarm", "scales", "RColorBrewer",
"RANN", "tm", "topicmodels")
# check packages that need to be installed.
packages.needed=setdiff(packages.used,
intersect(installed.packages()[,1],
packages.used))
# install additional packages
if(length(packages.needed)>0){
install.packages(packages.needed, dependencies = TRUE)
}
# load packages
library("rvest")
library("xml2")
library("qdap")
library("syuzhet")
library("ggplot2")
library("tm")
library("tidytext")
source("../lib/speechFuncs.R")
print(R.version)
main.page <- read_html(x = "http://www.presidency.ucsb.edu/inaugurals.php")
# Get link URLs
# f.speechlinks is a function for extracting links from the list of speeches.
inaug=f.speechlinks(main.page)
inaug=inaug[-nrow(inaug),] # remove the last line, irrelevant due to error.
inaug.list=read.csv("../data/inauglist.csv", stringsAsFactors = FALSE)
#delete the date column due to the formatting error
speech.list=cbind(inaug.list, inaug)
speech.list=speech.list[,-5]
#delete the date column due to formatting error
colnames(speech.list)[colnames(speech.list)=="links"]="Date"
#name the correct date
#abtract the year of the speech
speech.list$year = rep(NA,nrow(speech.list))
for ( i in 1:nrow(speech.list))
{  n = nchar(speech.list$Date[i])
speech.list$year[i] = as.numeric(substring(speech.list$Date[i],n-3,n))
}
words.partymean=tapply(speech.list$Words,speech.list$Party,mean)
ggplot(data = speech.list)+
geom_point(mapping = aes(x=year,y=Words,color=Party))+
geom_smooth(mapping = aes(x=year,y=Words),method="lm",se=F)
Demo=speech.list[speech.list$Party=="Democratic",]
Demo=Demo[!is.na(Demo$President),]
Repub=speech.list[speech.list$Party=="Republican",]
Repub=Repub[!is.na(Repub$President),]
Demo.Repub=rbind(Demo,Repub)
ggplot(data = Demo.Repub,mapping = aes(x=year,y=Words,color=Party))+
geom_point()+
geom_smooth(se=F)
speech.list2=speech.list[-which.max(speech.list$Words),]
speech.list2=speech.list2[-which.min(speech.list$Words),]
words.partymean2=tapply(speech.list2$Words,speech.list2$Party,mean)
ggplot(data = speech.list2)+
geom_point(mapping = aes(x=year,y=Words,color=Party))+
geom_smooth(mapping = aes(x=year,y=Words),method="lm",se=F)
# Loop over each row in speech.list
speech.list$fulltext=NA
for(i in seq(nrow(speech.list))) {
text <- read_html(speech.list$urls[i]) %>% # load the page
html_nodes(".displaytext") %>% # isloate the text
html_text() # get the text
speech.list$fulltext[i]=text
# Create the file name
filename <- paste0("../data/InauguralSpeeches/",
speech.list$File[i], "-",
speech.list$Term[i], ".txt")
sink(file = filename) %>% # open file to write
cat(text)  # write the file
sink() # close the file
}
sentence.list=NULL
for(i in 1:nrow(speech.list)){
sentences=sent_detect(speech.list$fulltext[i],
endmarks = c("?", ".", "!", "|",";"))
if(length(sentences)>0){
word.count=word_count(sentences)
sentence.list=rbind(sentence.list,
cbind(speech.list[i,-ncol(speech.list)],
sentences=as.character(sentences),
word.count,
sent.id=1:length(sentences)
)
)
}
}
sentence.list=sentence.list[!is.na(sentence.list$word.count),]
speech.list$word.count=tapply(sentence.list$word.count,sentence.list$year,mean)
ggplot(data = speech.list)+
geom_point(mapping = aes(x=year,y=word.count,color=Party))+
geom_smooth(mapping = aes(x=year,y=word.count),se=F,method="lm")
folder.path="../data/InauguralSpeeches/"
fulltext<-Corpus(DirSource(folder.path))
fulltext<-tm_map(fulltext, stripWhitespace)
fulltext<-tm_map(fulltext, content_transformer(tolower))
fulltext<-tm_map(fulltext, removeWords, stopwords("english"))
fulltext<-tm_map(fulltext, removeWords, character(0))
fulltext<-tm_map(fulltext, removePunctuation)
fulltext<-tm_map(fulltext, stemDocument)
text<-tm_map(fulltext, stripWhitespace)
fulltext<-tm_map(fulltext, removePunctuation)
fulltext<-tm_map(fulltext, removeNumbers)
fulltext<-tm_map(fulltext, PlainTextDocument)
dtm <- DocumentTermMatrix(fulltext)
dtms <- removeSparseTerms(dtm, 0.1)
freq <- sort(colSums(as.matrix(dtm)), decreasing=TRUE)
wf <- data.frame(word=names(freq), freq=freq)
ggplot(subset(wf, freq>200), aes(word, freq))+
geom_bar(stat="identity")+
theme(axis.text.x=element_text(angle=45, hjust=1))
freq <- sort(colSums(as.matrix(dtm)), decreasing=TRUE)
wf <- data.frame(word=names(freq), freq=freq)
ggplot(subset(wf, freq>200), aes(word, freq))+
geom_bar(stat="identity")+
theme(axis.text.x=element_text(angle=45, hjust=1))
freq <- sort(colSums(as.matrix(dtm)), decreasing=TRUE)
wf <- data.frame(word=names(freq), freq=freq)
ggplot(subset(wf, freq>300), aes(word, freq))+
geom_bar(stat="identity")+
theme(axis.text.x=element_text(angle=45, hjust=1))
